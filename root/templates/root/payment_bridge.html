<!-- templates/payment_bridge.html (در پروژه لندینگ) -->

<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>در حال انتقال...</title>
    <style>
        body { display: flex; justify-content: center; align-items: center; height: 100vh; font-family: tahoma; background: #f9f9f9; }
        .loader { border: 5px solid #f3f3f3; border-top: 5px solid #3498db; border-radius: 50%; width: 50px; height: 50px; animation: spin 2s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div style="text-align: center;">
        <div class="loader" style="margin: 0 auto 20px auto;"></div>
        <p>در حال بازگشت به نرم‌افزار...</p>
    </div>

    <script>
        const BACKEND_URL = "https://back.axonnegar.ir/payment/verify/bitpay/";

        // مقادیر توسط جنگو در اینجا قرار داده می‌شوند
        const trans_id = "{{ trans_id|default:'' }}";
        const id_get = "{{ id_get|default:'' }}";

        // اگر پارامترها وجود داشتند، URL نهایی را ساخته و ریدایرکت کن
        if (trans_id && id_get) {
            const redirectUrl = `${BACKEND_URL}?trans_id=${trans_id}&id_get=${id_get}`;
            window.location.href = redirectUrl;
        } else {
            // اگر به هر دلیلی بیت‌پی پارامترها را نفرستاد، یک پیام خطا نشان بده
            const errorUrl = `${BACKEND_URL}?error=missing_params_from_gateway`;
            window.location.href = errorUrl;
        }
    </script>
</body>
</html>